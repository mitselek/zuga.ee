---
interface Props {
  language: string;
  isHomepage?: boolean;
}

const { language, isHomepage = false } = Astro.props;

// Homepage uses anchor links, other pages use full URLs
const navigationItems = language === 'et'
  ? [
      { label: 'Etendused', href: isHomepage ? '#etendused' : `/et/#etendused`, anchor: 'etendused' },
      { label: 'Workshopid', href: isHomepage ? '#workshopid' : `/et/#workshopid`, anchor: 'workshopid' },
      { label: 'Meist', href: isHomepage ? '#about' : `/et/#about`, anchor: 'about' },
      { label: 'Galerii', href: isHomepage ? '#gallery' : `/et/#gallery`, anchor: 'gallery' },
      { label: 'Kontakt', href: isHomepage ? '#contact' : `/et/#contact`, anchor: 'contact' },
    ]
  : [
      { label: 'Performances', href: isHomepage ? '#etendused' : `/en/#etendused`, anchor: 'etendused' },
      { label: 'Workshops', href: isHomepage ? '#workshopid' : `/en/#workshopid`, anchor: 'workshopid' },
      { label: 'About', href: isHomepage ? '#about' : `/en/#about`, anchor: 'about' },
      { label: 'Gallery', href: isHomepage ? '#gallery' : `/en/#gallery`, anchor: 'gallery' },
      { label: 'Contact', href: isHomepage ? '#contact' : `/en/#contact`, anchor: 'contact' },
    ];

const currentPath = Astro.url.pathname;
---

<!-- Desktop navigation now hidden (handled by SectionNavigator) -->
<nav class="hidden" role="navigation" aria-hidden="true">
  {navigationItems.map((item) => (
    <a
      href={item.href}
      class="nav-link px-3 lg:px-4 py-2 rounded-md text-sm font-medium transition-colors text-gray-700 hover:bg-gray-100 hover:text-indigo-600"
      data-anchor={item.anchor}
    >
      {item.label}
    </a>
  ))}
</nav>

<!-- Mobile menu button -->
<button
  id="mobile-menu-button"
  class="md:hidden p-2 rounded-md text-gray-700 hover:bg-gray-100 transition-colors"
  aria-label={language === 'et' ? 'Menüü' : 'Menu'}
  aria-expanded="false"
  aria-controls="mobile-menu"
>
  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
  </svg>
</button>

<!-- Mobile menu -->
<div
  id="mobile-menu"
  class="hidden md:hidden absolute top-full left-0 right-0 shadow-lg bg-white border-t"
>
  <div class="px-4 py-3 space-y-1">
    {navigationItems.map((item) => (
      <a
        href={item.href}
        class="mobile-nav-link block px-4 py-3 rounded-md text-base font-medium transition-colors text-gray-700 hover:bg-gray-100 hover:text-indigo-600"
        data-anchor={item.anchor}
      >
        {item.label}
      </a>
    ))}
  </div>
</div>

<script>
  // Mobile menu toggle
  const button = document.getElementById('mobile-menu-button');
  const menu = document.getElementById('mobile-menu');

  if (button && menu) {
    button.addEventListener('click', () => {
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      button.setAttribute('aria-expanded', String(!isExpanded));
      menu.classList.toggle('hidden');
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!button.contains(e.target as Node) && !menu.contains(e.target as Node)) {
        button.setAttribute('aria-expanded', 'false');
        menu.classList.add('hidden');
      }
    });

    // Close menu when clicking a link
    const mobileLinks = menu.querySelectorAll('.mobile-nav-link');
    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        button.setAttribute('aria-expanded', 'false');
        menu.classList.add('hidden');
      });
    });
  }
</script>
