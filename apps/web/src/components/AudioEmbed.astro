---
interface AudioItem {
  platform: 'soundcloud' | 'err' | 'custom';
  track_id?: string;
  title?: string;
  url: string;
  source?: string;
  date?: string;
}

interface Props {
  audio: AudioItem[];
}

const { audio } = Astro.props;
---

{audio && audio.length > 0 && (
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    {audio.map((track) => (
      <div class="rounded-lg overflow-hidden shadow-lg bg-white">
        {track.title && (
          <div class="px-4 py-3 bg-slate-100 border-b border-slate-200">
            <h4 class="text-base font-semibold text-slate-900">{track.title}</h4>
            {track.source && track.date && (
              <p class="text-sm text-slate-600 mt-1">{track.source} â€¢ {new Date(track.date).toLocaleDateString('et-EE')}</p>
            )}
          </div>
        )}
        <div class="p-2">
          {track.platform === 'soundcloud' ? (
            <iframe
              width="100%"
              height="166"
              scrolling="no"
              frameborder="no"
              allow="autoplay"
              src={track.url}
              title={track.title || 'Audio track'}
              loading="lazy"
              class="w-full"
            ></iframe>
          ) : (
            <audio
              controls
              preload="none"
              class="w-full"
              src={track.url}
            >
              Your browser does not support the audio element.
            </audio>
          )}
        </div>
      </div>
    ))}
  </div>
)}
